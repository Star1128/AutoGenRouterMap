"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.unhook=exports.initHook=exports.StdHook=void 0;const wdk_1=require("@baize/wdk"),time_util_1=require("../../base/util/time-util");class StdHook{constructor(o,t){this.promise=o,this.unhook=t}}exports.StdHook=StdHook;const hook=(o,t)=>{const{write:r}=o;let e=wdk_1.noop;return new StdHook(new Promise((i=>{e=()=>{o.write=r,i()},o.write=o=>t(String(o))})),e)};function stdOutHook(o){return hook(process.stdout,o)}function stdErrHook(o){return hook(process.stderr,o)}const timePrefixLength=26,deprecationWarning="DeprecationWarning:";let outHook,errHook;function getOutHook(){return stdOutHook((o=>(outHook.unhook(),write(o,!0),outHook=getOutHook(),!0)))}function getErrHook(){return stdErrHook((o=>(errHook.unhook(),write(o),errHook=getErrHook(),!0)))}function write(o,t){const r=t?process.stdout:process.stderr;o.includes(deprecationWarning)||((0,time_util_1.isHvigorLogWithTime)(o)?r.write(o.substring(timePrefixLength)):r.write(o))}function initHook(){outHook=getOutHook(),errHook=getErrHook()}function unhook(){outHook.unhook(),errHook.unhook()}exports.initHook=initHook,exports.unhook=unhook;