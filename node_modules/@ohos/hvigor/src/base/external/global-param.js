"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.GlobalParam=void 0;const child_process_1=require("child_process"),fs_1=__importDefault(require("fs")),os_1=__importDefault(require("os")),path_1=__importDefault(require("path")),hvigor_log_js_1=require("../log/hvigor-log.js");class GlobalParam{static getInstance(){return this.instance||(this.instance=new GlobalParam),this.instance}constructor(){this._log=hvigor_log_js_1.HvigorLogger.getLogger("Init global params"),this.configuration=new Map,this._initialized=!1}load(){const t="Windows_NT"===os_1.default.type()?"npm.cmd":"npm",e=path_1.default.resolve(path_1.default.dirname(process.execPath),t);if(!fs_1.default.existsSync(e))return void this._log.debug("Npm not found.");const i=(0,child_process_1.execSync)(`"${e}" config list -l --json`,{encoding:"utf-8",windowsHide:!0});let o;try{o=JSON.parse(i);for(const[t,e]of Object.entries(o))this.configuration.set(t,e)}catch(t){this._log.error(t.message)}this._initialized=!0}getConfig(t){return this.check(),this.configuration.get(t)}setConfig(t,e){this.configuration.set(t,e)}check(){this._initialized||this.load()}}exports.GlobalParam=GlobalParam;