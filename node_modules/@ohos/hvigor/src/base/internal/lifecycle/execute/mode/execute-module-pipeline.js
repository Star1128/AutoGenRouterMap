"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ExecuteModulePipeline=void 0;const os_1=__importDefault(require("os")),index_js_1=require("../../../../../../index.js"),hvigor_trace_js_1=require("../../../../common/trace/hvigor-trace.js"),hvigor_log_js_1=require("../../../../log/hvigor-log.js"),sync_js_1=require("../../sync.js"),abstract_execute_pipeline_js_1=require("./abstract-execute-pipeline.js"),_log=hvigor_log_js_1.HvigorLogger.getLogger("hvigor-module-pipeline");class ExecuteModulePipeline extends abstract_execute_pipeline_js_1.AbstractExecutePipeline{constructor(e,t){super(e,t),this.executeModules=[],this.init()}init(){const e=index_js_1.hvigorCore.getExtraConfig().get("module");void 0===e?this.executeModules=this.project.getAllSubModules():(this.shouldCheckTask=!0,e.split(",").forEach((e=>{const t=e.split("@")[0],i=this.project.findModuleByName(t);void 0===i&&_log.errorMessageExit(`Unknown module '${t}' in the command line.${os_1.default.EOL}\t\tMake sure '${t}' module is set at the modules field in the build-profile.json5 file.${os_1.default.EOL}\t\tat ${this.project.getBuildProfilePath()}`),this.executeModules.push(i)})))}findPipeAllNeedExecuteSyncTasks(){const e=[];return this.executeModules.forEach((t=>{e.push(...(0,sync_js_1.findSyncTaskPathsForNode)(t))})),e}findPipeAllNeedExecuteTasks(){return this.findAllNeedExecuteTasksForNodes([...this.executeModules])}recordTraceData(){hvigor_trace_js_1.hvigorTrace.moduleNum=this.executeModules.length}}exports.ExecuteModulePipeline=ExecuteModulePipeline;