"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.HWorker=void 0;const worker_state_js_1=require("../enum/worker-state.js");class HWorker{constructor(e,t){this.melted=!1,this.cacheSize=0,this.worker=e,this.id=t,this.state=worker_state_js_1.WorkerState.IDLE,this.lastBusyTime=Date.now()}getState(){return this.state}getLastBusyTime(){return this.lastBusyTime}getId(){return this.id}terminate(e){this.setState(worker_state_js_1.WorkerState.DEAD),this.setLastBusyTime(Date.now()),this.worker.terminate().then(e())}setState(e){this.state=e}setLastBusyTime(e){this.lastBusyTime=e}doWork(e){return this.state===worker_state_js_1.WorkerState.IDLE&&(this.setState(worker_state_js_1.WorkerState.BUSY),this.curWorkId=e.getId(),this.curTaskInfo={hasSideEffects:e.hasSideEffects(),preludeDeps:e.getPreludeDeps()},this.worker.postMessage({id:e.getId(),workPath:e.getWorkPath(),inputData:e.getInputData(),exitAfterDone:e.hasSideEffects()}),!0)}getCurWorkId(){return this.curWorkId}cancelCurWorkId(){this.curWorkId=void 0}isMeltdown(){return this.melted}meltdown(){this.melted=!0}getCurTaskInfo(){return this.curTaskInfo}hasCache(){return this.cacheSize>0}updateCacheSize(e){this.cacheSize=e}sendMessageToWorker(e){this.worker.postMessage(e)}}exports.HWorker=HWorker;