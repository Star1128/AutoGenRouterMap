"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DaemonServerLifecycle=void 0;const daemon_const_js_1=require("../const/daemon-const.js"),hvigor_daemon_log_js_1=require("../log/hvigor-daemon-log.js"),port_util_js_1=require("../util/port-util.js"),hvigor_daemon_server_js_1=require("./hvigor-daemon-server.js"),_log=hvigor_daemon_log_js_1.HvigorDaemonLogger.getLogger("daemon");class DaemonServerLifecycle{async startListen(e){const o=await(0,port_util_js_1.tryUsePort)(daemon_const_js_1.DAEMON_SERVER_MIN_LISTEN_PORT);if(-1===o){const o="hvigor daemon: No available port was found in the specified range";_log.debug(o),e.emit(hvigor_daemon_server_js_1.DaemonServerEventName.LISTEN_FAILED,o)}else _log.debug(`hvigor daemon: Server start to listen. port=${o}`),e.listen(o,daemon_const_js_1.DAEMON_SERVER_LOCAL_HOST)}}exports.DaemonServerLifecycle=DaemonServerLifecycle;