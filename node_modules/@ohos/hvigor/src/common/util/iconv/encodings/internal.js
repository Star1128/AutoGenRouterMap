"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InternalEncoding=void 0;const string_decoder_1=require("string_decoder");class InternalCodec{constructor(e){var r;this.decoder=InternalDecoder,this.encoder=InternalEncoder,this.encodingName=e.encodingName,this.bomAware=null!==(r=e.bomAware)&&void 0!==r&&r,"utf8"===this.encodingName&&(this.encoder=InternalEncoderUtf8)}}class InternalDecoder{constructor(e,r){this.decoder=new string_decoder_1.StringDecoder(r.encodingName)}write(e){const r=Buffer.isBuffer(e)?e:Buffer.from(e);return this.decoder.write(r)}end(){return this.decoder.end()}}class InternalEncoder{constructor(e,r){this.encodingName=r.encodingName}write(e){return Buffer.from(e,this.encodingName)}end(){}}class InternalEncoderUtf8{constructor(e,r){this.highSurrogate="",this.enc=r.encodingName}write(e){if(this.highSurrogate&&(e=this.highSurrogate+e,this.highSurrogate=""),e.length>0){const r=e.charCodeAt(e.length-1);55296<=r&&r<56320&&(this.highSurrogate=e[e.length-1],e=e.slice(0,e.length-1))}return Buffer.from(e,this.enc)}end(){if(this.highSurrogate){const e=this.highSurrogate;return this.highSurrogate="",Buffer.from(e,this.enc)}}}exports.InternalEncoding={utf8:{type:"_internal",bomAware:!0},_internal:InternalCodec};