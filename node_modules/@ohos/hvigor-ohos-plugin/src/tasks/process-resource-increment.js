"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProcessResourceIncrement=void 0;const fs_extra_1=__importDefault(require("fs-extra")),path_1=__importDefault(require("path")),build_directory_const_js_1=require("../const/build-directory-const.js"),abstract_process_resource_increment_js_1=require("./abstract/abstract-process-resource-increment.js"),task_names_js_1=require("./common/task-names.js");var Task=task_names_js_1.TaskNames.Task;class ProcessResourceIncrement extends abstract_process_resource_increment_js_1.AbstractProcessResourceIncrement{constructor(e){super(e,Task.PREVIEW_PROCESS_RESOURCE),this.FIRST_SUPPORT_RESTOOL_IDSMAP_APIVERSION=10,this.restCommandContent=this.pathInfo.getIntermediatesRes(),this.outputDir=this.pathInfo.getIntermediatesRes(),this.idsMapDir=path_1.default.resolve(this.outputDir,build_directory_const_js_1.BuildDirConst.IDS_MAP)}initCommandBuilder(){this.restoolCommandBuilder=this.getRestoolCommandBuilder(),(this.service.getModuleModel().isHapModule()||this.service.getModuleModel().isHspModule())&&this.restoolCommandBuilder.addAppScopeResourcesDir(this.projectModel.getAppRes().getResourcePath());const e=this.projectModel.getAppRes().getAppResOpt().app.bundleName;this.restoolCommandBuilder.addJsonFile(this.processedJson).addModulePackName(e).addOutputDir(this.outputDir).addResTable(path_1.default.resolve(this.pathInfo.getGenerateSourceR(),build_directory_const_js_1.BuildArtifactConst.RESOURCE_TABLE_H)).incrementalCompile(),this.compileApiVersion>=this.FIRST_SUPPORT_RESTOOL_IDSMAP_APIVERSION&&(this.restoolCommandBuilder.addIdsPath(this.idsMapDir),fs_extra_1.default.existsSync(path_1.default.resolve(this.idsMapDir,"id_defined.json"))&&this.restoolCommandBuilder.addDefinedIds(this.idsMapDir)),this.sdkInfo.isOhos||this.restoolConfigBuilder.addDefinedSysIds(this.sdkInfo.getHosToolchainsDir())}}exports.ProcessResourceIncrement=ProcessResourceIncrement;