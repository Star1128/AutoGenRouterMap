"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.PreviewCompileResource=void 0;const fs_extra_1=__importDefault(require("fs-extra")),compile_resources_util_js_1=require("../utils/compile-resources-util.js"),ohos_logger_js_1=require("../utils/log/ohos-logger.js"),task_util_js_1=require("../utils/task-util.js"),abstract_compile_resource_js_1=require("./abstract/abstract-compile-resource.js"),task_names_js_1=require("./common/task-names.js");var Task=task_names_js_1.TaskNames.Task;class PreviewCompileResource extends abstract_compile_resource_js_1.AbstractCompileResource{constructor(e){super(e,Task.PREVIEW_COMPILE_RESOURCE),this._log=ohos_logger_js_1.OhosLogger.getLogger(PreviewCompileResource.name),this.generateSourceRDir=this.pathInfo.getGenerateSourceR(),this.processProfileTask=Task.PREVIEW_PROCESS_RESOURCE.name}declareExecutionCommand(){return this.compileCommands.toString()}initTaskDepends(){this.declareDepends((0,task_util_js_1.resolveHookDependency)(Task.PREVIEW_PROCESS_RESOURCE.name,this.targetName))}declareInputFiles(){const e=this.targetService.getTargetData().getPathInfo().getIntermediatesMergeProfile();return fs_extra_1.default.existsSync(e)?super.declareInputFiles().addEntry(e):super.declareInputFiles()}async doTaskAction(){await this.compilationProcess(compile_resources_util_js_1.CompileResourceBuildCommandType.COMMAND,this.targetData)}async invokeRestool(e){await this.previewCompileLink(this._log,(()=>{this.replaceTargetPages(e,this._log)}))}}exports.PreviewCompileResource=PreviewCompileResource;