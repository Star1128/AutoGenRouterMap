"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ProcessResourceIncrementCA=exports.CompileResourceCA=exports.ProcessResourceCA=exports.initResourceTasks=void 0;const inject_util_js_1=require("../../utils/inject-util.js"),task_names_js_1=require("../common/task-names.js"),compile_resource_js_1=require("../compile-resource.js"),legacy_process_profile_js_1=require("../legacy-tasks/legacy-process-profile.js"),process_profile_js_1=require("../process-profile.js"),process_resource_js_1=require("../process-resource.js"),process_resource_increment_js_1=require("../process-resource-increment.js"),process_router_map_js_1=require("../process-router-map.js"),task_creator_js_1=require("../task-creator.js"),unit_test_process_profile_js_1=require("../unitTest/unit-test-process-profile.js"),generate_ohos_test_template_js_1=require("../ohosTest/generate-ohos-test-template.js"),common_const_js_1=require("../../const/common-const.js"),ohos_test_util_js_1=require("../../utils/ohos-test-util.js"),initResourceTasks=(e,s)=>{e.registry(new ProcessResourceCA(s)),e.registry(new CompileResourceCA(s)),e.registry(new ProcessResourceIncrementCA(s))};exports.initResourceTasks=initResourceTasks;class ProcessResourceCA extends task_creator_js_1.TargetTaskCreator{constructor(){super(...arguments),this.declareTaskDetail=()=>task_names_js_1.TaskNames.Task.PROCESS_RESOURCE,this.provider=()=>new process_resource_js_1.ProcessResource(this.targetService)}declareDepends(){const e=[this.isFa?legacy_process_profile_js_1.LegacyProcessProfile.name:process_profile_js_1.ProcessProfile.name];return inject_util_js_1.InjectUtil.isUnitTestProcess()&&e.push(unit_test_process_profile_js_1.UnitTestProcessProfile.name),e}}exports.ProcessResourceCA=ProcessResourceCA;class CompileResourceCA extends task_creator_js_1.TargetTaskCreator{constructor(){super(...arguments),this.declareTaskDetail=()=>task_names_js_1.TaskNames.Task.COMPILE_RESOURCE,this.provider=()=>new compile_resource_js_1.CompileResource(this.targetService)}declareDepends(){const e=[process_resource_js_1.ProcessResource.name,process_router_map_js_1.ProcessRouterMap.name],s=this.targetService.getTargetData().getTargetName();if(s!==common_const_js_1.DefaultTargetConst.OHOS_TEST_TARGET)return e;const r=this.targetService.getModuleService().getModuleModel().getSourceRootByTargetName(s);return(0,ohos_test_util_js_1.isTemplatesAfterSourceCodeMigration)(r)&&e.push(generate_ohos_test_template_js_1.GenerateOhosTestTemplate.name),e}}exports.CompileResourceCA=CompileResourceCA;class ProcessResourceIncrementCA extends task_creator_js_1.TargetTaskCreator{constructor(){super(...arguments),this.declareDepends=()=>[process_profile_js_1.ProcessProfile.name],this.declareTaskDetail=()=>task_names_js_1.TaskNames.Task.PREVIEW_PROCESS_RESOURCE,this.provider=()=>new process_resource_increment_js_1.ProcessResourceIncrement(this.targetService)}}exports.ProcessResourceIncrementCA=ProcessResourceIncrementCA;