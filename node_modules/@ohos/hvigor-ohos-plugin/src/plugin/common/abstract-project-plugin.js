"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AbstractProjectPlugin=void 0;const hvigor_1=require("@ohos/hvigor"),build_mode_manager_js_1=require("../../project/build-option/build-mode-manager.js"),clean_js_1=require("../../tasks/common/clean.js"),task_names_js_1=require("../../tasks/common/task-names.js"),assemble_app_js_1=require("../../tasks/hook/assemble/assemble-app.js"),project_inspection_js_1=require("../../tasks/inspection/project-inspection.js"),sync_project_js_1=require("../../tasks/sync/sync-project.js"),ohos_plugin_id_js_1=require("./ohos-plugin-id.js");var SyncTask=task_names_js_1.TaskNames.SyncTask;const project_ohos_config_manager_js_1=require("../../common/global/project-ohos-config-manager.js"),ohos_project_context_impl_js_1=require("../context/impl/ohos-project-context-impl.js");class AbstractProjectPlugin extends hvigor_1.HvigorSystemPlugin{constructor(e){super(ohos_plugin_id_js_1.OhosPluginId.OHOS_APP_PLUGIN),this._project=e,this._projectName=e.getName()}doRegisterTask(){this.assembleApp=new assemble_app_js_1.AssembleApp(this._project,this._taskService),this.clean=new clean_js_1.Clean(this._project,this._taskService),this.syncProject=new sync_project_js_1.SyncProject(this._project,SyncTask.syncTaskName(this._projectName)),this._project.registry(this.assembleApp),this._project.registry(this.clean),this._project.registry(this.syncProject)}doProjectInspection(){new project_inspection_js_1.ProjectInspection(this._projectModel).doInspection().exitOnError()}initBuildOptionMap(){build_mode_manager_js_1.buildOptionManager.initProjectBuildOptions(this._projectModel)}initTraceData(){hvigor_1.hvigorTrace.taskTime={...hvigor_1.hvigorTrace.taskTime,compileArkTS:0,buildArkTS:0,compileJS:0,buildJS:0,compileResource:0,packageHap:0,signHap:0}}initGlobalData(){var e;const s=null===(e=this._project.getConfigOpt())||void 0===e?void 0:e.getObject("ohos");s&&project_ohos_config_manager_js_1.projectOhosConfigManager.loaderConfig(s)}getTaskService(){return this._taskService}getProjectModel(){return this._projectModel}initContext(){const e=new ohos_project_context_impl_js_1.OhosProjectContextImpl(this,this._taskService);this.ohosAppContext=e}getContext(){return this.ohosAppContext}}exports.AbstractProjectPlugin=AbstractProjectPlugin;