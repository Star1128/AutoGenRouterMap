"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LegacyPluginBuilder=void 0;const common_const_js_1=require("../../const/common-const.js"),hap_extra_info_js_1=require("../../project/data/hap-extra-info.js"),ohos_logger_js_1=require("../../utils/log/ohos-logger.js"),ohos_plugin_id_js_1=require("../common/ohos-plugin-id.js"),legacy_hap_plugin_js_1=require("../legacy/legacy-hap-plugin.js"),legacy_har_plugin_js_1=require("../legacy/legacy-har-plugin.js"),core_plugin_builder_js_1=require("./core-plugin-builder.js");class LegacyPluginBuilder extends core_plugin_builder_js_1.CorePluginBuilder{constructor(e){super(e),this._log=ohos_logger_js_1.OhosLogger.getLogger(LegacyPluginBuilder.name)}setUpModulePlugin(e){e.doModuleInspection(),e.initModuleTaskService(!0),e.initBuildOptionMap(),e.initTargetDepends(),e.initModuleCommonTasks(),e.initModuleCommonTasksForDiffApiType(!0)}createFaHapPlugin(){return this.initPluginParam(new legacy_hap_plugin_js_1.LegacyHapPlugin(this.module),!0)}createFaHarPlugin(){return this.initPluginParam(new legacy_har_plugin_js_1.LegacyHarPlugin(this.module),!1)}initPluginParam(e,i){const o=this.createProjectModel(),r=this.createModuleModel(o,i);return e.withProjectModel(o).withModuleModel(r).withPluginApiType(hap_extra_info_js_1.ApiType.FA).withRuntimeConfigFileName(common_const_js_1.CommonConst.CONFIG_JSON)}createProjectModel(){const e=this.module.getProject(),i=e.getPluginById(ohos_plugin_id_js_1.OhosPluginId.OHOS_APP_PLUGIN);return i||this._log._buildError(`Invalid exports, no system plugins were found in hvigorfile: ${[e.getBuildFilePath()]}`)._printErrorAndExit(),i.getProjectModel()}}exports.LegacyPluginBuilder=LegacyPluginBuilder;