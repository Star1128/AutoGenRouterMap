"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PluginBuilder=void 0;const common_const_js_1=require("../../const/common-const.js"),hap_extra_info_js_1=require("../../project/data/hap-extra-info.js"),ohos_logger_js_1=require("../../utils/log/ohos-logger.js"),ohos_plugin_id_js_1=require("../common/ohos-plugin-id.js"),hap_plugin_js_1=require("../hap-plugin.js"),har_plugin_js_1=require("../har-plugin.js"),hsp_plugin_js_1=require("../hsp-plugin.js"),core_plugin_builder_js_1=require("./core-plugin-builder.js");class PluginBuilder extends core_plugin_builder_js_1.CorePluginBuilder{constructor(e){super(e),this._log=ohos_logger_js_1.OhosLogger.getLogger(PluginBuilder.name)}createStageHapPlugin(){return this.initPluginParam(new hap_plugin_js_1.HapPlugin(this.module),!0)}createStageHspPlugin(){return this.initPluginParam(new hsp_plugin_js_1.HspPlugin(this.module),!0)}createStageHarPlugin(){return this.initPluginParam(new har_plugin_js_1.HarPlugin(this.module),!1)}initPluginParam(e,i){const o=this.createProjectModel(),r=this.createModuleModel(o,i);return e.withProjectModel(o).withModuleModel(r).withPluginApiType(hap_extra_info_js_1.ApiType.STAGE).withRuntimeConfigFileName(common_const_js_1.CommonConst.MODULE_JSON5)}setUpModulePlugin(e){e.doModuleInspection(),e.initModuleTaskService(!1),e.initBuildOptionMap(),e.initTargetDepends(),e.initModuleCommonTasksForDiffApiType(!1)}createProjectModel(){const e=this.module.getProject(),i=e.getPluginById(ohos_plugin_id_js_1.OhosPluginId.OHOS_APP_PLUGIN);return i||this._log._buildError("Invalid exports, no system plugins were found in hvigorfile")._file(`${[e.getBuildFilePath()]}.ts`)._printErrorAndExit(),i.getProjectModel()}}exports.PluginBuilder=PluginBuilder;