"use strict";var __importDefault=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.OhosSdkInfo=void 0;const hvigor_1=require("@ohos/hvigor"),sdkmanager_common_1=require("@ohos/sdkmanager-common"),fs_extra_1=__importDefault(require("fs-extra")),path_1=__importDefault(require("path")),sdk_const_js_1=require("../../const/sdk-const.js"),ohos_logger_js_1=require("../../utils/log/ohos-logger.js"),ohos_sdk_loader_js_1=require("../ohos-sdk-loader.js"),common_sdk_info_js_1=require("./common-sdk-info.js"),meta_util_js_1=require("../../utils/meta-util.js"),_log=ohos_logger_js_1.OhosLogger.getLogger("ohos-sdk-info");class OhosSdkInfo extends common_sdk_info_js_1.CommonSdkInfo{constructor(o,s,e){super(s,e),this.ohosLocalComponents=new Map,this.isOhos=!0,this.ohComponents=o,this.setOhosMetaCompileSdkVersion()}setOhosMetaCompileSdkVersion(){(0,meta_util_js_1.updateMetaCompileSdkVersion)(this.sdkVersion.version)}async setup(){const o=process.hrtime(),s=[];this.ohComponents.forEach((o=>s.push(new sdkmanager_common_1.PathAndApiVersion(o,this.sdkVersion.version)))),this.ohosLocalComponents=await ohos_sdk_loader_js_1.OhosSdkLoader.getInstance().getOhosSdkComponents(this.sdkVersion,this.ohComponents),s.forEach((o=>this.initComponent(this.contains(o,this.ohosLocalComponents)))),this.hasRollUpPluginInJsLoader=fs_extra_1.default.existsSync(path_1.default.resolve(this.getJsLoader(),sdk_const_js_1.ToolChainsConst.ROLL_UP_CONFIG_FILE)),this.hasRollUpPluginInEtsLoader=fs_extra_1.default.existsSync(path_1.default.resolve(this.getEtsLoader(),sdk_const_js_1.ToolChainsConst.ROLL_UP_CONFIG_FILE));const e=process.hrtime(o);_log.debug(`Sdk init in ${(0,hvigor_1.formatTime)(e)}`)}contains(o,s){for(const[e,t]of s)if(e.equals(o))return t}}exports.OhosSdkInfo=OhosSdkInfo;