"use strict";var __importDefault=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.HosSdkInfo=void 0;const hvigor_1=require("@ohos/hvigor"),sdkmanager_common_1=require("@ohos/sdkmanager-common"),fs_extra_1=__importDefault(require("fs-extra")),path_1=__importDefault(require("path")),sdk_const_js_1=require("../../const/sdk-const.js"),ohos_logger_js_1=require("../../utils/log/ohos-logger.js"),hmos_sdk_loader_js_1=require("../hmos-sdk-loader.js"),hms_core_ets_component_js_1=require("../impl/hms-core-ets-component.js"),hms_core_native_component_js_1=require("../impl/hms-core-native-component.js"),sdk_java_component_js_1=require("../impl/sdk-java-component.js"),sdk_toolchains_component_js_1=require("../impl/sdk-toolchains-component.js"),sdk_util_js_1=require("../sdk-util.js"),common_sdk_info_js_1=require("./common-sdk-info.js"),_log=ohos_logger_js_1.OhosLogger.getLogger("hos-sdk-info");class HosSdkInfo extends common_sdk_info_js_1.CommonSdkInfo{constructor(o,e,t){super(e,t),this.localHosLibComponents=new Map,this.localLibComponents=new Map,this.sdkDir=t,this.hosComponents=o,this.hmsCoreComponents=[sdkmanager_common_1.ComponentPath.TOOLCHAINS],this.hosComponents.forEach((o=>{e.version>9&&(o===sdkmanager_common_1.ComponentPath.ETS||o===sdkmanager_common_1.ComponentPath.NATIVE)&&this.hmsCoreComponents.push(o)}))}async setup(){const o=process.hrtime(),e=hmos_sdk_loader_js_1.HmosSdkLoader.getInstance();this.localLibComponents=await e.getHmosSdkComponents(this.sdkVersion,this.hosComponents),this.localHosLibComponents=await e.getHmsSdkComponents(this.sdkVersion,this.hmsCoreComponents),this.hosComponents.forEach((o=>this.initComponent((0,sdk_util_js_1.contains)(o,this.localLibComponents)))),this.hmsCoreComponents.forEach((o=>this.hmsComponentInit((0,sdk_util_js_1.contains)(o,this.localHosLibComponents)))),this.ohJavaComponent=new sdk_java_component_js_1.SdkJavaComponent((0,sdk_util_js_1.contains)(sdkmanager_common_1.ComponentPath.TOOLCHAINS,this.localLibComponents)),this.hasRollUpPluginInEtsLoader=fs_extra_1.default.existsSync(path_1.default.resolve(this.getEtsLoader(),sdk_const_js_1.ToolChainsConst.ROLL_UP_CONFIG_FILE)),this.hasRollUpPluginInJsLoader=fs_extra_1.default.existsSync(path_1.default.resolve(this.getJsLoader(),sdk_const_js_1.ToolChainsConst.ROLL_UP_CONFIG_FILE));const t=process.hrtime(o);_log.debug(`Sdk init in ${(0,hvigor_1.formatTime)(t)}`)}hmsComponentInit(o){switch(o.getPath()){case sdkmanager_common_1.ComponentPath.NATIVE:this.hmsCoreNativeComponent=new hms_core_native_component_js_1.HmsCoreNativeComponent(o);break;case sdkmanager_common_1.ComponentPath.ETS:this.hmsCoreEtsComponent=new hms_core_ets_component_js_1.HmsCoreEtsComponent(o);break;case sdkmanager_common_1.ComponentPath.TOOLCHAINS:this.hosJavaComponent=new sdk_java_component_js_1.SdkJavaComponent(o),this.hosToolchainsComponent=new sdk_toolchains_component_js_1.HosSdkToolchainsComponent(o)}}getHmsArkDir(){return this.hmsCoreEtsComponent.getBaseDir()}getHmsNativeDir(){return this.hmsCoreNativeComponent.getBaseDir()}getHmsToolchainFile(){return this.hmsCoreNativeComponent.getHmsToolchainFile()}getHmsBiShengToolchainFile(){return this.hmsCoreNativeComponent.getHmsBiShengToolchainFile()}getRestool(){var o,e;return null!==(e=null===(o=this.toolchainsComponent)||void 0===o?void 0:o.getRestoolPath())&&void 0!==e?e:""}getHosResTool(){return this.hosJavaComponent.getRestoolPath()}getModuleSchema(){return this.hosToolchainsComponent.getHosModuleSchema()}getAppSchema(){return this.hosToolchainsComponent.getAppSchema()}getInsightIntentSchema(){return this.toolchainsComponent.getInsightIntentSchema()}getArkDataSchema(){return this.hosToolchainsComponent.getArkDataSchema()}getUtdSchema(){return this.toolchainsComponent.getUtdSchema()}getRichSchema(){return this.hosToolchainsComponent.getRichSchema()}getLiteSchema(){return this.hosToolchainsComponent.getLiteSchema()}getHapSignToolV2(){return this.hosToolchainsComponent.getHapSignToolV2()}getAbilityShellJar(){return this.hosJavaComponent.getAbilityShellJarPath()}getAceJar(){return this.hosJavaComponent.getAceJarPath()}getOhosJar(){return this.hosJavaComponent.getOhosJarPath()}getHosModuleSchema(){return this.hosToolchainsComponent.getHosModuleSchema()}getReleaseType(){return this.hosToolchainsComponent.getReleaseType()}getHosToolchainsComponentVersion(){return this.hosToolchainsComponent.getComponentVersion().getVersion()}getHosToolchainsDir(){return this.hosToolchainsComponent.getBaseDir()}getHosSignTool(){return this.hosToolchainsComponent.getHosSignTool()}}exports.HosSdkInfo=HosSdkInfo;