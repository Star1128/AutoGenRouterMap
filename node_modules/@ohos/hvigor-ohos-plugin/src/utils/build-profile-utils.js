"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.getRuntimeOnlyObjMap=exports.generateExportClass=exports.generateConstVariable=exports.normalizedFileData=void 0;const fs_extra_1=__importDefault(require("fs-extra")),path_1=__importDefault(require("path")),array_util_js_1=require("./array-util.js"),normalizedFileData=(e,t,r)=>`${(0,exports.generateConstVariable)(e,t,r)}\n${(0,exports.generateExportClass)(e)}`;exports.normalizedFileData=normalizedFileData;const generateConstVariable=(e,t,r)=>{const a="export const ";let s="/**\n * Use these variables when you tailor your ArkTS code. They must be of the const type.\n */\n";return Object.keys(e).forEach((o=>{const n=e[o];"string"==typeof n?s+=`${a+o} = '${n}';\n`:"number"==typeof n||"boolean"==typeof n?s+=`${a+o} = ${n};\n`:r._buildError(`buildProfileFields only support number/string/boolean,not support ${typeof n}, the value ${n} does not meet the requirements.`)._file(t.getModuleModel().getProfilePath())._printErrorAndExit()})),s};exports.generateConstVariable=generateConstVariable;const generateExportClass=e=>{let t="/**\n * BuildProfile Class is used only for compatibility purposes.\n */\nexport default class BuildProfile { \n";return Object.keys(e).forEach((e=>{t+=`\t${"static readonly "+e} = ${e};\n`})),t+="}",t};exports.generateExportClass=generateExportClass;const getRuntimeOnlyObjMap=(e,t,r,a)=>{const s=new Map;return t?(t.sources&&t.sources.forEach((t=>{const r=path_1.default.resolve(e,t);fs_extra_1.default.existsSync(r)&&s.set(t,r)})),t.packages&&(0,array_util_js_1.isSubset)(r,t.packages)&&s.set(`runtimeOnlyPackages${null!=a?a:""}`,t.packages),s):s};exports.getRuntimeOnlyObjMap=getRuntimeOnlyObjMap;